# Инструкция по развертыванию мира ходьбы

В данном файле содержится информация о всех шагах, которые стоит предпринять для разворота мира ходьбы на Вашем локальном устройстве.

## Системные требования:

Данная инструкция была протестирована на следующих конфигурациях системы:

- Win11 + WSL2: Ubuntu 20.04.6 LTS; Python: 3.11
- Ubuntu 22.04.3 LTS (dual boot);   Python: 3.10

## Запуск

Для полноценного запуска следует выполнить следующие шаги

## Шаг 1: предварительные действия

### Git

Сперва стоит проверить, установлен ли Git на компьютере. Для этого можно ввести в консоль команду 

```bash
$ git --version
```

Если в выводе не будет указана установленная версия Git, то надо выполнить действия, описанные в инструкции на [сайте Git](https://git-scm.com/download/linux).

---

### Python

Для дальнейшей работы с миром ходьбы необходим установленный интерпретатор Python 3. Проверить текущую версию интерпретатора можно, введя в консоль команду:

```bash
$ python3 --version
```

Если интерпретатор не установлен, то следует воспользовать инструкцей по установке. Можно рассмотреть один из вариантов, представленных в [этой статье](https://phoenixnap.com/kb/how-to-install-python-3-ubuntu).

---

### Система сборки

Для сборки библиотеки понадобится также система сборки CMake. Проверить её версию можно, используя команду консоли:

```bash
$ cmake --version
```

Если же система не установлена, то можно выполнить команду

```bash
$ sudo apt install cmake
```

чтобы установить последнюю версию CMake. Можно также воспользоваться и другими методами установки, если это необходимо.


## Шаг 2: установка webots

Для работы с миром ходьбы необходимо установить [webots](http://cyberbotics.com). 

Тут есть несколько возможных вариантов

### Вариант 1: простая установка

Данный способ достаточно простой. В результате на устройстве будет рабочая последняя версия webots, готовая для запуска с контроллерами из настоящей библиотеки.

Первым делом необходимо скачать пакет **webots_xxxxx_amd64.deb** с официального сайта [webots](http://cyberbotics.com). После этого переходим в папку со скачанным пакетом и устанавливаем его командой 

```bash
$ sudo apt --fix-broken install ./webots_2023b_amd64.deb
```

### Вариант 2: RoboCup Humanoid webots

Этот вариант представляет интерес из-за некоторых возможностей, которые не поддерживаются текущей версие webots. Например, в данной версии webots поддерживается люфт, что может быть полезно в некоторых задачах.

...

## Шаг 3: установка ROS noetic desktop

Кроме того, для полноценной работы необходим ROS - Robot Operating System - набор программных средств для разработки програмного обеспечения для робота.

Здесь возможно несколько вариантов:

### WSL

В случае работы с WSL можно установить [ros noetic desktop](https://wiki.ros.org/noetic). Его можно установить по [официальной инструкции](https://wiki.ros.org/noetic/Installation/Ubuntu).

### Dual boot

Если основной операционной системой является Linux или он установлен в качестве второй ОС, то стоит установить [ROS2](https://www.ros.org/). Например, [ros-humble-desktop](https://docs.ros.org/en/humble/Installation.html), используя официальную инструкцию.

К этой инструкции стоит добавить, что можно указать источник ROS2 setup.bash в .bashrc, чтобы ROS2 был доступен при каждом запуске терминала.

Для этого стоит выаполнить команду 

```bash
$ echo "source /opt/ros/humble/source.bash" >> ~/.bashrc
```

После этого можно обновить консоль. Кроме того, при каждом открытии можно свободно использовать ROS2.

### Шаг 3: дополнительные пакеты

Во время установки ros можно выполнить установку дополнительных пакетов. Вам понадобятся [tkinter](https://wiki.python.org/moin/TkInter) и [eigen3](https://eigen.tuxfamily.org/index.php?title=Main_Page). Для этого можно использовать команды:

```bash

$ sudo apt install python3-tk
$ sudo apt install libeigen3-dev

```

### Шаг 4: сборка библиотеки для работы мира

Далее необходимо клонировать репозиторий [ik_walk](https://github.com/StarkitRobots/starkit_ik_walk) и обновить его, добавляя библиотеки [pybind11](https://github.com/pybind/pybind11) и [eigen](https://eigen.tuxfamily.org/index.php?title=Main_Page). Для этого нужно выполнить команды

```bash

$ git clone ...
$ git submodules update --init --recursive

```

После этого переходим в папку с библиотекой и собираем проект, используя [CMake](https://cmake.org/)

```bash

$ cd libraries/IKWalk
$ mkdir build
$ cd build
$ cmake ..
$ cmake --build .

```

Получившийся файл с расширением .so необходимо переместить в папку controllers/ik_walk/

### Шаг 5: запуск мира

После выполнения всех действий можно перейти в папку worlds и запустить мир

```bash

$ cd worlds
$ webots sahr.wbt

```
После этого процесс установки мира можно считать завершённым